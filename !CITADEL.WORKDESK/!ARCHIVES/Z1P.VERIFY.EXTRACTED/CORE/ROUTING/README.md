///‚ñô‚ññ‚ñô‚ññ‚ñû‚ñû‚ñô‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ
‚ñõ//‚ñû‚ñû ‚ü¶‚éä‚üß :: ‚ßó-25.61 // DOCS ‚ñû‚ñû
‚ñû//‚ñû Routing System :: œÅ{documentation}.œÜ{routing}.œÑ{guide}.Œª{core} ‚´∏
‚ñô‚å±üìö ‚âî [‚ä¢{system-design}‚á®{implement}‚üø{operate}‚ñ∑{scale}]
„Äî3OX.Ai.core.routing.documentation„Äï :: ‚àé

# 3OX.Ai Routing System

**Status:** ‚úÖ Operational ‚ßó-25.61  
**Purpose:** Resource-efficient file state tracking and routing between stations and BASE.OPS

---

## üéØ System Overview

This system solves two critical problems:

1. **Resource Efficiency**: AI agents read lightweight logs instead of scanning entire folders
2. **Output Tracking**: Files generated by stations automatically route to BASE.OPS for detection

### Architecture

```
[STATION]
‚îú‚îÄ‚îÄ .3ox/FILE.STATE.LOG        ‚Üê Lightweight state tracking (read this, not files)
‚îî‚îÄ‚îÄ 0ut.3ox/                   ‚Üê Output folder for transit
    ‚îú‚îÄ‚îÄ FILE.MANIFEST.txt      ‚Üê What to send
    ‚îú‚îÄ‚îÄ [output-files]         ‚Üê Files ready for transit
    ‚îî‚îÄ‚îÄ .SENT/                 ‚Üê Archive of sent files
         ‚Üì
    (Transit via router.py - no storage in 3OX.Ai)
         ‚Üì
!BASE.OPERATIONS/INCOMING/
‚îú‚îÄ‚îÄ [station-name]/            ‚Üê Received files organized by station
‚îÇ   ‚îî‚îÄ‚îÄ [files]
‚îî‚îÄ‚îÄ REGISTRY.LOG               ‚Üê Central tracking
```

---

## üìã Components

### 1. FILE.STATE.LOG Specification
**Location:** `3OX.Ai/.3ox.index/CORE/ROUTING/FILE.STATE.LOG.SPEC.md`

Defines lightweight file state tracking format:
```
[TIMESTAMP] | ACTION | FILEPATH | SIZE | HASH
[2025-10-07 14:23:15] | ADD | projects/report.md | 2048 | abc123def456789...
```

**Benefit:** AI reads log instead of scanning hundreds of files.

### 2. 0ut.3ox Protocol Specification
**Location:** `3OX.Ai/.3ox.index/CORE/ROUTING/0UT.3OX.PROTOCOL.SPEC.md`

Defines how files transit from stations to BASE.OPS:
- Manifest format (what to send)
- Routing process (station ‚Üí CMD ‚Üí BASE.OPS)
- Archive system (.SENT folder)
- Loop prevention (one-way flow)

### 3. Station Registry
**Location:** `3OX.Ai/.3ox.index/CORE/ROUTING/STATIONS/`

Tracks connected stations without storing their files:
- `RVNx.BASE.routing` - Remote access station
- `OBSIDIAN.BASE.routing` - Knowledge base station  
- `SYNTH.BASE.routing` - Creative/experimental station

Each file contains station metadata (path, priority, destination).

### 4. Transit Router
**Location:** `3OX.Ai/.3ox.index/CORE/ROUTING/router.py`

Python script that orchestrates file transit:
- Reads manifests from all enabled stations
- Moves files to BASE.OPS/INCOMING/
- Updates manifest status (READY ‚Üí TRANSIT ‚Üí SENT)
- Archives originals to .SENT folder
- Logs to central REGISTRY.LOG

**No files stored in 3OX.Ai** - pure transit orchestration.

### 5. BASE.OPS Detector
**Location:** `!BASE.OPERATIONS/detector.py`

Monitors INCOMING/ folder for new files:
- Detects new arrivals
- Logs to REGISTRY.LOG
- Maintains state file (avoids duplicate detection)
- Supports watch mode for continuous monitoring

### 6. Central Registry
**Location:** `!BASE.OPERATIONS/INCOMING/REGISTRY.LOG`

Central log of all file transits:
```
[TIMESTAMP] | STATION | FILENAME | SIZE | STATUS | NOTES
[2025-10-07 00:01:09] | rvnx | report.md | 4096 | RECEIVED | OK
```

---

## üöÄ Usage

### For AI Agents Working in Stations

#### Read State Log (Resource Efficient)
```python
# Instead of scanning entire folder (expensive)
state_log = read_file("RVNx.BASE/.3ox/FILE.STATE.LOG")
recent_changes = filter_by_timestamp(state_log, since="today")
# Now you know what changed without reading every file
```

#### Send Output to BASE.OPS
```python
# 1. Generate your output file
create_file("RVNx.BASE/0ut.3ox/my-report.md", content)

# 2. Add entry to manifest
append_to_manifest(
    timestamp="2025-10-07 15:00:00",
    status="READY",
    filepath="my-report.md",
    destination="INCOMING/rvnx",
    priority="HIGH"
)

# 3. Transit will happen automatically (or trigger manually)
```

### Manual Routing

```powershell
# Route files from all stations to BASE.OPS
python 3OX.Ai\.3ox.index\CORE\ROUTING\router.py

# Output:
# üöÄ 3OX.Ai Transit Router
# ==================================================
# üì° Found 3 enabled station(s)
# 
# üîç Checking: RVNx.BASE
#    Found 1 file(s) ready for transit
# ‚úì Routed: my-report.md ‚Üí rvnx/
#   ‚Ü≥ Archived to .SENT/2025-10-07/
# 
# ==================================================
# ‚úÖ Transit complete: 1 file(s) routed to BASE.OPS
```

### Manual Detection

```powershell
# Detect new files in BASE.OPS once
python !BASE.OPERATIONS\detector.py

# Watch mode (continuous monitoring)
python !BASE.OPERATIONS\detector.py --watch 5  # Check every 5 seconds
```

### Check Status

```powershell
# View central registry
cat !BASE.OPERATIONS\INCOMING\REGISTRY.LOG

# Check pending files in RVNx
cat RVNx.BASE\0ut.3ox\FILE.MANIFEST.txt | findstr "READY"

# View received files
ls !BASE.OPERATIONS\INCOMING\rvnx\
```

---

## ‚úÖ Tested & Verified

**Test Run:** ‚ßó-25.61

1. ‚úÖ Created test file in `RVNx.BASE/0ut.3ox/SYSTEM.STATUS.REPORT.md`
2. ‚úÖ Added to FILE.MANIFEST.txt with STATUS=READY
3. ‚úÖ Ran `router.py` - File transited to `!BASE.OPERATIONS/INCOMING/rvnx/`
4. ‚úÖ Original archived to `.SENT/2025-10-07/`
5. ‚úÖ Manifest updated to STATUS=TRANSIT
6. ‚úÖ Ran `detector.py` - File detected and logged
7. ‚úÖ REGISTRY.LOG contains complete tracking history

**Result:** System fully operational! üéâ

---

## üîí Loop Prevention

**Critical Design Principle:**

```
‚úì Files flow ONE WAY: Station ‚Üí CMD ‚Üí BASE.OPS
‚úó Files NEVER sync back to stations
‚úó Files NEVER stored in 3OX.Ai (transit only)
‚úó BASE.OPS content NEVER syncs to local drives
```

This prevents infinite sync loops as explained in `!BASE.OPERATIONS/!WHY.THIS.EXISTS.txt`.

---

## üé® Adding New Stations

### Step 1: Create Station Routing Config
```ruby
# 3OX.Ai/.3ox.index/CORE/ROUTING/STATIONS/NEWSTATION.BASE.routing
station_name: NEWSTATION.BASE
station_path: P:/!CMD.BRIDGE/NEWSTATION.BASE
output_folder: 0ut.3ox
manifest_file: 0ut.3ox/FILE.MANIFEST.txt
destination: INCOMING/newstation
priority: MEDIUM
enabled: true
last_sync: ‚ßó-25.61
notes: Description of station purpose
```

### Step 2: Create Station Folders
```powershell
New-Item -ItemType Directory -Path "NEWSTATION.BASE\.3ox"
New-Item -ItemType Directory -Path "NEWSTATION.BASE\0ut.3ox"
New-Item -ItemType Directory -Path "NEWSTATION.BASE\0ut.3ox\.SENT"
```

### Step 3: Create Station Files
```powershell
# FILE.STATE.LOG
copy 3OX.Ai\.3ox.index\CORE\ROUTING\FILE.STATE.LOG.SPEC.md NEWSTATION.BASE\.3ox\FILE.STATE.LOG

# FILE.MANIFEST.txt
copy RVNx.BASE\0ut.3ox\FILE.MANIFEST.txt NEWSTATION.BASE\0ut.3ox\
```

### Step 4: Test
```powershell
# Add test file to manifest, then:
python 3OX.Ai\.3ox.index\CORE\ROUTING\router.py
python !BASE.OPERATIONS\detector.py
```

---

## üìä Benefits

### Resource Efficiency
- ‚úÖ Read logs instead of scanning file systems
- ‚úÖ No wasted context on unchanged files
- ‚úÖ Scalable to massive folder structures

### Output Tracking
- ‚úÖ All station outputs centrally logged
- ‚úÖ Complete audit trail in REGISTRY.LOG
- ‚úÖ Automatic archiving of sent files

### Multi-Agent Safety
- ‚úÖ Loop-safe by design
- ‚úÖ One-way flow prevents circular syncs
- ‚úÖ 3OX.Ai routes without storing

### Transparency
- ‚úÖ View connection registry in STATIONS/
- ‚úÖ Check manifest for pending files
- ‚úÖ Read REGISTRY.LOG for complete history

---

## üîß Maintenance

### Rotate Logs
If FILE.STATE.LOG exceeds 10,000 lines:
```powershell
mv RVNx.BASE\.3ox\FILE.STATE.LOG RVNx.BASE\.3ox\FILE.STATE.LOG.01
# System will create new log automatically
```

### Clean Archives
Periodically clean .SENT folders:
```powershell
# Remove archives older than 30 days
Get-ChildItem -Path "RVNx.BASE\0ut.3ox\.SENT" -Recurse | 
    Where-Object {$_.LastWriteTime -lt (Get-Date).AddDays(-30)} | 
    Remove-Item -Recurse
```

### Monitor Registry
```powershell
# Check for errors
cat !BASE.OPERATIONS\INCOMING\REGISTRY.LOG | findstr "ERROR"

# View today's activity
cat !BASE.OPERATIONS\INCOMING\REGISTRY.LOG | findstr "2025-10-07"
```

---

## üìö Related Documentation

- `FILE.STATE.LOG.SPEC.md` - State tracking format
- `0UT.3OX.PROTOCOL.SPEC.md` - Routing protocol details
- `!BASE.OPERATIONS/!WHY.THIS.EXISTS.txt` - Loop prevention architecture

---

**System Status:** ‚úÖ Operational  
**Last Updated:** ‚ßó-25.61  
**Authority:** 3OX.Ai Core Routing System

